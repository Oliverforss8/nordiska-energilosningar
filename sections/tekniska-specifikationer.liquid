{% liquid
  assign section_id = section.settings.custom_id | default: section.id
  assign section_class = 'section-tekniska-specifikationer'
%}

<section
  id="{{ section_id }}"
  class="{{ section_class }} layout py-[60px] md:py-[85px]"
>
  {% if section.settings.title != blank %}
    <h2 class="headline1 pb-[40px] text-center text-[#171717] md:pb-[50px]">
      {{ section.settings.title }}
    </h2>
  {% endif %}

  <div class="flex flex-col gap-[40px] md:gap-[50px] lg:flex-row">
    <!-- Bildkarusell -->
    <div class="flex-1">
      {% if section.settings.image_1 != blank
        or section.settings.image_2 != blank
        or section.settings.image_3 != blank
      %}
        <div class="relative">
          <div class="image-carousel h-[400px] overflow-hidden rounded-[15px] md:h-[500px]">
            {% if section.settings.image_1 != blank %}
              <img
                src="{{ section.settings.image_1 | image_url: width: 1600 }}"
                srcset="{{ section.settings.image_1 | image_url: width: 800 }} 800w, {{ section.settings.image_1 | image_url: width: 1200 }} 1200w, {{ section.settings.image_1 | image_url: width: 1600 }} 1600w, {{ section.settings.image_1 | image_url: width: 2000 }} 2000w"
                sizes="(min-width: 1024px) 800px, 100vw"
                alt="{{ section.settings.image_1.alt | default: section.settings.product_name }}"
                class="carousel-image h-full w-full object-contain transition-opacity duration-500"
                data-image-index="0"
                width="1600"
                height="1000"
                loading="lazy"
              >
            {% endif %}
            {% if section.settings.image_2 != blank %}
              <img
                src="{{ section.settings.image_2 | image_url: width: 1600 }}"
                srcset="{{ section.settings.image_2 | image_url: width: 800 }} 800w, {{ section.settings.image_2 | image_url: width: 1200 }} 1200w, {{ section.settings.image_2 | image_url: width: 1600 }} 1600w, {{ section.settings.image_2 | image_url: width: 2000 }} 2000w"
                sizes="(min-width: 1024px) 800px, 100vw"
                alt="{{ section.settings.image_2.alt | default: section.settings.product_name }}"
                class="carousel-image absolute inset-0 h-full w-full object-contain opacity-0 transition-opacity duration-500"
                data-image-index="1"
                width="1600"
                height="1000"
                loading="lazy"
              >
            {% endif %}
            {% if section.settings.image_3 != blank %}
              <img
                src="{{ section.settings.image_3 | image_url: width: 1600 }}"
                srcset="{{ section.settings.image_3 | image_url: width: 800 }} 800w, {{ section.settings.image_3 | image_url: width: 1200 }} 1200w, {{ section.settings.image_3 | image_url: width: 1600 }} 1600w, {{ section.settings.image_3 | image_url: width: 2000 }} 2000w"
                sizes="(min-width: 1024px) 800px, 100vw"
                alt="{{ section.settings.image_3.alt | default: section.settings.product_name }}"
                class="carousel-image absolute inset-0 h-full w-full object-contain opacity-0 transition-opacity duration-500"
                data-image-index="2"
                width="1600"
                height="1000"
                loading="lazy"
              >
            {% endif %}
          </div>

          <!-- Karusellpunkter -->
          <div class="flex justify-center gap-[10px] pt-[20px]">
            {% if section.settings.image_1 != blank %}
              <button
                class="carousel-dot h-[12px] w-[12px] rounded-full bg-[#171717] opacity-100 transition-opacity duration-300"
                data-dot-index="0"
              ></button>
            {% endif %}
            {% if section.settings.image_2 != blank %}
              <button
                class="carousel-dot h-[12px] w-[12px] rounded-full bg-[#171717] opacity-30 transition-opacity duration-300"
                data-dot-index="1"
              ></button>
            {% endif %}
            {% if section.settings.image_3 != blank %}
              <button
                class="carousel-dot h-[12px] w-[12px] rounded-full bg-[#171717] opacity-30 transition-opacity duration-300"
                data-dot-index="2"
              ></button>
            {% endif %}
          </div>
        </div>
      {% else %}
        <div class="flex h-[400px] w-full items-center justify-center rounded-[15px] bg-gray-200 text-gray-500 md:h-[500px]">
          Välj produktbilder
        </div>
      {% endif %}
    </div>

    <!-- Produktdetaljer -->
    <div class="flex flex-1 flex-col">
      <!-- Specifikationer -->
      {% if section.blocks.size > 0 %}
        <div class="specifications relative flex flex-col gap-[20px]">
          <!-- Kontinuerlig vertikal linje -->
          <div
            class="absolute bottom-0 left-1/2 top-0 w-[1px] -translate-x-1/2 transform bg-[#E5E5E5]"
          ></div>

          {% for block in section.blocks %}
            {% if block.type == 'specification' %}
              <div
                class="spec-item relative flex flex-row items-center border-b border-[#E5E5E5] pb-[15px]"
                {{ block.shopify_attributes }}
              >
                <span class="text flex-1 pr-[20px] font-[500] text-[#171717]">
                  {{ block.settings.label }}
                </span>
                <span class="text flex-1 pl-[20px] text-right text-[#171717]">
                  {{ block.settings.value }}
                </span>
              </div>
            {% endif %}
          {% endfor %}
        </div>
      {% endif %}

      {% if section.settings.button_text != blank and section.settings.button_link != blank %}
        <div class="pt-[40px]">
          <a
            href="{{ section.settings.button_link }}"
            class="knappetikett inline-flex items-center gap-[20px] rounded-[10px] bg-[#E9A600] px-[20px] py-[17px] text-[#171717] transition-colors hover:bg-[#D4B82A]"
          >
            {{ section.settings.button_text }}
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="22"
              height="18"
              viewBox="0 0 22 18"
              fill="none"
            >
              <path d="M1 8.99991H21L13.1739 1.17383" stroke="#171717" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              <path d="M1 9.00009H21L13.1739 16.8262" stroke="#171717" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </a>
        </div>
      {% endif %}
    </div>
  </div>
</section>

<script src="{{ 'tekniska-specifikationer.js' | asset_url }}" defer></script>

{% schema %}
{
  "name": "Tekniska specifikationer",
  "tag": "section",
  "class": "section-tekniska-specifikationer",
  "settings": [
    {
      "type": "text",
      "id": "title",
      "label": "Rubrik",
      "default": "Tekniska specifikationer"
    },
    {
      "type": "header",
      "content": "Produktbilder"
    },
    {
      "type": "image_picker",
      "id": "image_1",
      "label": "Första bilden"
    },
    {
      "type": "image_picker",
      "id": "image_2",
      "label": "Andra bilden"
    },
    {
      "type": "image_picker",
      "id": "image_3",
      "label": "Tredje bilden"
    },
    {
      "type": "header",
      "content": "Produktinformation"
    },
    {
      "type": "text",
      "id": "product_name",
      "label": "Produktnamn",
      "default": "Produktnamn"
    },
    {
      "type": "text",
      "id": "stack_info",
      "label": "Stack information",
      "default": "Stack"
    },
    {
      "type": "textarea",
      "id": "description",
      "label": "Beskrivning",
      "default": "Produktbeskrivning här..."
    },
    {
      "type": "header",
      "content": "Knapp"
    },
    {
      "type": "text",
      "id": "button_text",
      "label": "Knapptext"
    },
    {
      "type": "url",
      "id": "button_link",
      "label": "Knapplänk"
    },
    {
      "type": "text",
      "id": "custom_id",
      "label": "Anpassat ID",
      "info": "Lämna tomt för att använda standard ID"
    }
  ],
  "blocks": [
    {
      "type": "specification",
      "name": "Specifikation",
      "settings": [
        {
          "type": "text",
          "id": "label",
          "label": "Etikett",
          "default": "Specifikation"
        },
        {
          "type": "text",
          "id": "value",
          "label": "Värde",
          "default": "Värde"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Tekniska specifikationer"
    }
  ]
}
{% endschema %}
