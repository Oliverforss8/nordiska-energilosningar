{% liquid
  assign section_id = section.settings.custom_id | default: section.id
  assign section_class = 'section-' | append: section.type
%}

<section
  id="{{ section_id }}"
  class="{{ section_class }} layout py-[60px] md:py-[85px]"
>
  {% if section.settings.heading != blank %}
    <div class="headline1 text-[60px]">
      {{ section.settings.heading }}
    </div>
  {% endif %}

  {% if section.settings.description != blank %}
    <div class="body1 py-[50px] text-[20px] opacity-80">
      {{ section.settings.description }}
    </div>
  {% endif %}

  {% if section.blocks.size > 0 %}
    <div class="grid grid-cols-1 gap-[30px] md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4">
      {% for block in section.blocks %}
        <div
          class="relative text-center"
          {{ block.shopify_attributes }}
        >
          {% if block.settings.image != blank %}
            {% liquid
              assign has_contact_info = false
              if block.settings.email != blank or block.settings.phone != blank
                assign has_contact_info = true
              endif
            %}

            <div
              class="group relative flex h-[400px] flex-shrink-0 cursor-pointer flex-col justify-between rounded-[15px] pb-[20px] pl-[20px] transition-all duration-300 {% if has_contact_info %}hover-card{% endif %}"
              style="background: linear-gradient(180deg, rgba(0, 0, 0, 0.00) 37.02%, rgba(0, 0, 0, 0.75) 100%), url({{ block.settings.image | image_url: width: 600 }}) lightgray 50% / cover no-repeat;"
              {% unless has_contact_info %}
                onclick="window.location.href='#kontakt'"
              {% endunless %}
            >
              <!-- Default content -->
              <div class="default-content transition-opacity duration-300 {% if has_contact_info %}group-hover:opacity-0{% endif %}">
                {% if block.settings.title != blank %}
                  <div class="flex w-full justify-end">
                    <button class="headline rounded-bl-[10px] bg-white p-[16px] text-[18px]">
                      {{ block.settings.title }}
                    </button>
                  </div>
                {% endif %}
              </div>

              <div class="default-content flex flex-col pr-[20px] transition-opacity duration-300 {% if has_contact_info %}group-hover:opacity-0{% endif %}">
                {% if block.settings.name != blank %}
                  <h3 class="headline1 text-left text-[40px] text-white">
                    {{ block.settings.name }}
                  </h3>
                {% endif %}
                <div class="pt-[20px]">
                  <button
                    class="knappetikett flex flex-row items-center gap-[20px] rounded-[10px] px-[20px] py-[17px] text-[#171717]"
                    style="background: linear-gradient(0deg, rgba(255, 255, 255, 0.20) 0%, rgba(255, 255, 255, 0.20) 100%), #EBCF2F;"
                  >
                    Kontakt
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      width="22"
                      height="18"
                      viewBox="0 0 22 18"
                      fill="none"
                    >
                      <path d="M1 8.99991H21L13.1739 1.17383" stroke="#171717" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                      <path d="M1 9.00009H21L13.1739 16.8262" stroke="#171717" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                  </button>
                </div>
              </div>

              <!-- Hover overlay with contact info -->
              {% if has_contact_info %}
                <div class="absolute inset-0 flex flex-col items-center justify-center rounded-[15px] bg-black/65 p-[20px] text-center opacity-0 transition-opacity duration-300 group-hover:opacity-100">
                  {% if block.settings.name != blank %}
                    <h3 class="headline1 text-[32px] text-white">
                      {{ block.settings.name }}
                    </h3>
                  {% endif %}

                  <div class="flex w-full flex-col gap-[25px]  pt-[50px]">
                    {% if block.settings.email != blank %}
                      <a
                        href="mailto:{{ block.settings.email }}"
                        class="headline1 flex items-center justify-center gap-[10px] rounded-[10px] text-[20px] text-white"
                      >
                        <svg
                          width="20"
                          height="16"
                          viewBox="0 0 20 16"
                          fill="none"
                          xmlns="http://www.w3.org/2000/svg"
                        >
                          <path d="M18 0H2C0.9 0 0.00999999 0.9 0.00999999 2L0 14C0 15.1 0.9 16 2 16H18C19.1 16 20 15.1 20 14V2C20 0.9 19.1 0 18 0ZM18 4L10 9L2 4V2L10 7L18 2V4Z" fill="currentColor"/>
                        </svg>
                        {{ block.settings.email }}
                      </a>
                    {% endif %}

                    {% if block.settings.phone != blank %}
                      <a
                        href="tel:{{ block.settings.phone }}"
                        class="headline1 flex items-center justify-center gap-[10px] rounded-[10px] text-[20px] text-white"
                      >
                        <svg
                          width="18"
                          height="18"
                          viewBox="0 0 18 18"
                          fill="none"
                          xmlns="http://www.w3.org/2000/svg"
                        >
                          <path d="M3.62 7.79C5.06 10.62 7.38 12.93 10.21 14.38L12.41 12.18C12.68 11.91 13.08 11.82 13.43 11.93C14.55 12.3 15.75 12.5 17 12.5C17.55 12.5 18 12.95 18 13.5V17C18 17.55 17.55 18 17 18C7.61 18 0 10.39 0 1C0 0.45 0.45 0 1 0H4.5C5.05 0 5.5 0.45 5.5 1C5.5 2.25 5.7 3.45 6.07 4.57C6.18 4.92 6.09 5.31 5.82 5.59L3.62 7.79Z" fill="currentColor"/>
                        </svg>
                        {{ block.settings.phone }}
                      </a>
                    {% endif %}
                  </div>
                </div>
              {% endif %}
            </div>
          {% else %}
            <!-- Fallback when no image -->
            {% if block.settings.name != blank %}
              <h3 class="headline2 mb-[10px] text-[24px]">
                {{ block.settings.name }}
              </h3>
            {% endif %}

            {% if block.settings.title != blank %}
              <p class="body1 text-[16px] opacity-70">
                {{ block.settings.title }}
              </p>
            {% endif %}
          {% endif %}
        </div>
      {% endfor %}
    </div>
  {% endif %}
</section>

{% schema %}
{
  "name": "Medarbetare",
  "tag": "section",
  "class": "section-medarbetare",
  "settings": [
    {
      "type": "text",
      "id": "custom_id",
      "label": "Anpassat ID",
      "info": "Använd ett anpassat ID för denna sektion"
    },
    {
      "type": "inline_richtext",
      "id": "heading",
      "label": "Rubrik",
      "default": "Team Nordiska"
    },
    {
      "type": "richtext",
      "id": "description",
      "label": "Beskrivning",
      "default": "<p>Våra kärnvärden är mer än ord – de speglar vilka vi är och hur vi arbetar varje dag. De vägleder oss i mötet med kunder, i samarbetet med kollegor och i hur vi bygger vår företagskultur. Genom våra kärnvärden skapar vi en arbetsmiljö där människor trivs, växer och gör skillnad – tillsammans.</p>"
    }
  ],
  "blocks": [
    {
      "type": "team_member",
      "name": "Medarbetare",
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "Bild"
        },
        {
          "type": "text",
          "id": "name",
          "label": "Namn",
          "default": "Namn"
        },
        {
          "type": "text",
          "id": "title",
          "label": "Titel/Befattning"
        },
        {
          "type": "text",
          "id": "email",
          "label": "E-post",
          "info": "Om ifylld visas kontaktinfo vid hover, annars går klick till #kontakt"
        },
        {
          "type": "text",
          "id": "phone",
          "label": "Telefonnummer",
          "info": "Om ifylld visas kontaktinfo vid hover, annars går klick till #kontakt"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Medarbetare",
      "blocks": [
        {
          "type": "team_member",
          "settings": {
            "name": "Anna Andersson",
            "title": "VD"
          }
        },
        {
          "type": "team_member",
          "settings": {
            "name": "Erik Eriksson",
            "title": "Säljchef"
          }
        },
        {
          "type": "team_member",
          "settings": {
            "name": "Maria Nilsson",
            "title": "Projektledare"
          }
        },
        {
          "type": "team_member",
          "settings": {
            "name": "Johan Svensson",
            "title": "Tekniker"
          }
        }
      ]
    }
  ]
}
{% endschema %}
