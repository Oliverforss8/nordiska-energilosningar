<section>
  <div class="layout flex flex-col">
    <h2 class="headline1 text-center text-[#171717]">
      {{ section.settings.heading }}
    </h2>
  </div>

  <!-- Product Menu Tabs -->
  <div class="mb-[30px] mt-[30px] flex flex-wrap justify-center gap-[15px] px-[20px] md:mb-[40px] md:mt-[40px] md:gap-[30px]">
    {% if section.settings.product_1 != blank %}
      <button
        class="product-tab text relative px-[8px] py-[12px] text-[18px] transition-colors md:px-[10px] md:py-[15px] md:text-[25px]"
        data-product="product-1"
        style="color: #171717; opacity: 0.3; background: none; border: none;"
      >
        {{ section.settings.product_1.title }}
      </button>
    {% endif %}

    {% if section.settings.product_2 != blank %}
      <button
        class="product-tab text relative px-[8px] py-[12px] text-[18px] transition-colors md:px-[10px] md:py-[15px] md:text-[25px]"
        data-product="product-2"
        style="color: #171717; opacity: 0.3; background: none; border: none;"
      >
        {{ section.settings.product_2.title }}
      </button>
    {% endif %}

    {% if section.settings.product_3 != blank %}
      <button
        class="product-tab text relative px-[8px] py-[12px] text-[18px] transition-colors md:px-[10px] md:py-[15px] md:text-[25px]"
        data-product="product-3"
        style="color: #171717; opacity: 0.3; background: none; border: none;"
      >
        {{ section.settings.product_3.title }}
      </button>
    {% endif %}

    {% if section.settings.product_4 != blank %}
      <button
        class="product-tab text relative px-[8px] py-[12px] text-[18px] transition-colors md:px-[10px] md:py-[15px] md:text-[25px]"
        data-product="product-4"
        style="color: #171717; opacity: 0.3; background: none; border: none;"
      >
        {{ section.settings.product_4.title }}
      </button>
    {% endif %}

    {% if section.settings.product_5 != blank %}
      <button
        class="product-tab text relative px-[8px] py-[12px] text-[18px] transition-colors md:px-[10px] md:py-[15px] md:text-[25px]"
        data-product="product-5"
        style="color: #171717; opacity: 0.3; background: none; border: none;"
      >
        {{ section.settings.product_5.title }}
      </button>
    {% endif %}
  </div>

  <!-- Product Content Area -->
  <div class="layout">
    <div class="product-content-container">
      <div class="flex flex-col items-center justify-between gap-[25px] md:flex-row md:gap-[50px]">
        <div class="relative h-[250px] w-full sm:h-[300px] md:h-[450px] md:w-[2500px] lg:w-[450px] lg:shrink-0">
          <img
            id="product-image"
            class="h-full w-full rounded-[10px] object-contain md:rounded-[15px]"
            width="450"
            height="450"
            loading="lazy"
            alt=""
          >
        </div>

        <div class="flex w-full flex-col md:w-auto">
          <div
            class="headline1 text-[#171717]text-left"
            id="product-title"
          ></div>
          <div
            class="text pt-[20px] text-center leading-[110%] text-[#171717]/80 md:pt-[50px] md:text-left"
            %
            id="product-description"
          ></div>
          <div class="flex justify-start pt-[25px] md:pt-[50px]">
            <a
              id="product-link"
              class="knappetikett flex flex-row items-center gap-[20px] rounded-full px-[20px] py-[17px] text-[#171717]"
              style="background: #E9A600; text-decoration: none;"
            >
              LÃ¤s mer
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="22"
                height="18"
                viewBox="0 0 22 18"
                fill="none"
              >
                <path d="M1 8.99991H21L13.1739 1.17383" stroke="#171717" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M1 9.00009H21L13.1739 16.8262" stroke="#171717" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<script>
  // Product data from Shopify
  const products = {
    'product-1': {
      {% if section.settings.product_1 != blank %}
        title: "{{ section.settings.product_1_custom_title | default: section.settings.product_1.title | escape }}",
        description: `{{ section.settings.product_1_custom_description | default: section.settings.product_1.description | strip_html }}`,
        url: "{{ section.settings.product_1.url }}",
        image: "{{ section.settings.product_1.featured_image | image_url: width: 450 }}",
        alt: "{{ section.settings.product_1.featured_image.alt | default: section.settings.product_1.title | escape }}"
      {% endif %}
    },
    'product-2': {
      {% if section.settings.product_2 != blank %}
        title: "{{ section.settings.product_2_custom_title | default: section.settings.product_2.title | escape }}",
        description: `{{ section.settings.product_2_custom_description | default: section.settings.product_2.description | strip_html }}`,
        url: "{{ section.settings.product_2.url }}",
        image: "{{ section.settings.product_2.featured_image | image_url: width: 450 }}",
        alt: "{{ section.settings.product_2.featured_image.alt | default: section.settings.product_2.title | escape }}"
      {% endif %}
    },
    'product-3': {
      {% if section.settings.product_3 != blank %}
        title: "{{ section.settings.product_3_custom_title | default: section.settings.product_3.title | escape }}",
        description: `{{ section.settings.product_3_custom_description | default: section.settings.product_3.description | strip_html }}`,
        url: "{{ section.settings.product_3.url }}",
        image: "{{ section.settings.product_3.featured_image | image_url: width: 450 }}",
        alt: "{{ section.settings.product_3.featured_image.alt | default: section.settings.product_3.title | escape }}"
      {% endif %}
    },
    'product-4': {
      {% if section.settings.product_4 != blank %}
        title: "{{ section.settings.product_4_custom_title | default: section.settings.product_4.title | escape }}",
        description: `{{ section.settings.product_4_custom_description | default: section.settings.product_4.description | strip_html }}`,
        url: "{{ section.settings.product_4.url }}",
        image: "{{ section.settings.product_4.featured_image | image_url: width: 450 }}",
        alt: "{{ section.settings.product_4.featured_image.alt | default: section.settings.product_4.title | escape }}"
      {% endif %}
    },
    'product-5': {
      {% if section.settings.product_5 != blank %}
        title: "{{ section.settings.product_5_custom_title | default: section.settings.product_5.title | escape }}",
        description: `{{ section.settings.product_5_custom_description | default: section.settings.product_5.description | strip_html }}`,
        url: "{{ section.settings.product_5.url }}",
        image: "{{ section.settings.product_5.featured_image | image_url: width: 450 }}",
        alt: "{{ section.settings.product_5.featured_image.alt | default: section.settings.product_5.title | escape }}"
      {% endif %}
    }
  };

  document.addEventListener('DOMContentLoaded', function () {
    const tabs = document.querySelectorAll('.product-tab');
    const productImage = document.getElementById('product-image');
    const productTitle = document.getElementById('product-title');
    const productDescription = document.getElementById('product-description');
    const productLink = document.getElementById('product-link');

    // Show first product by default
    if (tabs.length > 0) {
      const firstProduct = tabs[0].getAttribute('data-product');
      updateProductContent(firstProduct);
      // Set active tab styling
      tabs[0].style.opacity = '1';
      tabs[0].style.borderBottom = '2px solid #e9a600';
    }

    function truncateWords(text, maxWords) {
      const words = text.trim().split(/\s+/);
      if (words.length <= maxWords) {
        return text;
      }
      return words.slice(0, maxWords).join(' ') + '...';
    }

    function updateProductContent(productId) {
      const product = products[productId];
      if (product) {
        productImage.src = product.image;
        productImage.alt = product.alt;
        productTitle.textContent = product.title;
        productDescription.textContent = truncateWords(product.description, 30);
        productLink.href = product.url;
      }
    }

    tabs.forEach((tab) => {
      tab.addEventListener('click', function () {
        const targetProduct = this.getAttribute('data-product');

        // Reset all tab styles
        tabs.forEach((t) => {
          t.style.opacity = '0.3';
          t.style.borderBottom = 'none';
        });

        // Update content and highlight active tab
        updateProductContent(targetProduct);
        this.style.opacity = '1';
        this.style.borderBottom = '2px solid #e9a600';
      });
    });
  });
</script>

{% schema %}
{
  "name": "Product Menu",
  "tag": "section",
  "class": "section-product-menu",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Our products"
    },
    {
      "type": "product",
      "id": "product_1",
      "label": "Product 1"
    },
    {
      "type": "text",
      "id": "product_1_custom_title",
      "label": "Product 1 - Custom title (optional)",
      "info": "Leave blank to use product's title"
    },
    {
      "type": "textarea",
      "id": "product_1_custom_description",
      "label": "Product 1 - Custom description (optional)",
      "info": "Leave blank to use product's description"
    },
    {
      "type": "product",
      "id": "product_2",
      "label": "Product 2"
    },
    {
      "type": "text",
      "id": "product_2_custom_title",
      "label": "Product 2 - Custom title (optional)",
      "info": "Leave blank to use product's title"
    },
    {
      "type": "textarea",
      "id": "product_2_custom_description",
      "label": "Product 2 - Custom description (optional)",
      "info": "Leave blank to use product's description"
    },
    {
      "type": "product",
      "id": "product_3",
      "label": "Product 3"
    },
    {
      "type": "text",
      "id": "product_3_custom_title",
      "label": "Product 3 - Custom title (optional)",
      "info": "Leave blank to use product's title"
    },
    {
      "type": "textarea",
      "id": "product_3_custom_description",
      "label": "Product 3 - Custom description (optional)",
      "info": "Leave blank to use product's description"
    },
    {
      "type": "product",
      "id": "product_4",
      "label": "Product 4"
    },
    {
      "type": "text",
      "id": "product_4_custom_title",
      "label": "Product 4 - Custom title (optional)",
      "info": "Leave blank to use product's title"
    },
    {
      "type": "textarea",
      "id": "product_4_custom_description",
      "label": "Product 4 - Custom description (optional)",
      "info": "Leave blank to use product's description"
    },
    {
      "type": "product",
      "id": "product_5",
      "label": "Product 5"
    },
    {
      "type": "text",
      "id": "product_5_custom_title",
      "label": "Product 5 - Custom title (optional)",
      "info": "Leave blank to use product's title"
    },
    {
      "type": "textarea",
      "id": "product_5_custom_description",
      "label": "Product 5 - Custom description (optional)",
      "info": "Leave blank to use product's description"
    }
  ],
  "presets": [
    {
      "name": "Product Menu"
    }
  ]
}
{% endschema %}
