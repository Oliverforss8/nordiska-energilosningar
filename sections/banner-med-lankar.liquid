<section class='layout  py-[62px] md:py-[87px]'>
  <div
    class='h-[500px] md:py-[40px] p-[20px] md:px-[50px] w-full rounded-[10px] bg-cover bg-center bg-no-repeat relative'
    style='background-color: {{ section.settings.background_color }}; {% if section.settings.background_image %}background-image: url({{ section.settings.background_image | image_url: width: 1200 }});{% endif %}'
  >
    {% if section.settings.background_image
      and section.settings.overlay_opacity > 0
    %}
      <div
        class='absolute inset-0 rounded-[10px]'
        style='background-color: {{ section.settings.overlay_color | default: section.settings.background_color }}; opacity: {{ section.settings.overlay_opacity | divided_by: 100.0 }};'
      ></div>
    {% endif %}
    <div class='flex h-full justify-between flex-col relative z-10'>
      <div>
        {% if section.settings.header_button_text != blank %}
          <a
            href='{{ section.settings.header_button_url }}'
            class='knappetikett2 bg-transparent text-white p-[15px] rounded-[10px] z-10 inline-block'
            style='border: 1px solid #fff;'
          >
            {{ section.settings.header_button_text }}
          </a>
        {% endif %}
      </div>
      <div class='flex lg:w-[840px] flex-col gap-[30px]'>
        {% if section.settings.heading != blank %}
          <h2 class='text-white headline2 '>
            {{ section.settings.heading }}
          </h2>
        {% endif %}
        {% if section.settings.description != blank %}
          <p class='text-white knappetikett'>
            {{ section.settings.description }}
          </p>
        {% endif %}
        <div class='flex flex-row gap-[10px]'>
          {% if section.settings.primary_button_text != blank %}
            <a
              href='{{ section.settings.primary_button_url }}'
              class='px-[20px] flex flex-row gap-[20px] items-center rounded-[10px] py-[17px] knappetikett shrink-0 text-[#171717]'
              style='background: linear-gradient(0deg, rgba(255, 255, 255, 0.20) 0%, rgba(255, 255, 255, 0.20) 100%), #EBCF2F;'
            >
              {{ section.settings.primary_button_text }}
              <svg
                xmlns='http://www.w3.org/2000/svg'
                width='22'
                height='18'
                viewBox='0 0 22 18'
                fill='none'
              >
                <path d="M1 8.99991H21L13.1739 1.17383" stroke="#171717" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M1 9.00009H21L13.1739 16.8262" stroke="#171717" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </a>
          {% endif %}
          {% if section.settings.secondary_button_text != blank %}
            <a
              href='{{ section.settings.secondary_button_url }}'
              class='px-[20px] flex flex-row gap-[20px] items-center rounded-[10px] py-[17px] knappetikett shrink-0 bg-transparent text-white'
              style='border: 1px solid #fff;'
            >
              {{ section.settings.secondary_button_text }}
              <svg
                xmlns='http://www.w3.org/2000/svg'
                width='22'
                height='18'
                viewBox='0 0 22 18'
                fill='none'
              >
                <path d="M1 8.99991H21L13.1739 1.17383" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M1 8.9996H21L13.1739 16.8257" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </a>
          {% endif %}
        </div>
      </div>
    </div>
  </div>

  <div
    class='pt-[20px] lg:pt-[30px] grid grid-cols-1 lg:grid-cols-3 gap-[20px]'
    id='banner-cards-container'
  >
    {% for block in section.blocks %}
      {% if block.type == "card" %}
        <a
          class='banner-card p-[20px] md:p-[30px] rounded-[15px] no-underline transition-all duration-300{% if forloop.first %} active{% endif %}'
          href='{{ block.settings.link }}'
          style='background-color: {% if forloop.first %}{{ block.settings.card_bg_color | default: "#F3F1E8" }}{% else %}white{% endif %};'
          data-hover-bg='{{ block.settings.card_bg_color | default: "#F3F1E8" }}'
          data-hover-text='{{ block.settings.card_text_color | default: "#171717" }}'
          data-is-first='{% if forloop.first %}true{% else %}false{% endif %}'
        >
          <div>
            {% if block.settings.heading != blank %}
              <div class='flex flex-row items-center justify-between'>
                <h3
                  class='banner-card-title headline1 decoration-none text-[24px] md:text-[36px] transition-colors duration-300'
                  style='color: {% if forloop.first %}{{ block.settings.card_text_color | default: "#171717" }}{% else %}#171717{% endif %};'
                >
                  {{ block.settings.heading }}
                </h3>
                <div>
                  <svg
                    class='banner-card-arrow transition-all duration-300'
                    xmlns='http://www.w3.org/2000/svg'
                    width='30'
                    height='24'
                    viewBox='0 0 30 24'
                    fill='none'
                  >
                    <path d="M2 12H27.5556L17.5556 2" stroke="{% if forloop.first %}{{ block.settings.card_text_color | default: '#171717' }}{% else %}#171717{% endif %}" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M2 12H27.5556L17.5556 22" stroke="{% if forloop.first %}{{ block.settings.card_text_color | default: '#171717' }}{% else %}#171717{% endif %}" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                </div>
              </div>
            {% endif %}
            {% if block.settings.description != blank %}
              <p
                class='banner-card-desc text pt-[20px] md:pt-[30px] transition-colors duration-300'
                style='color: {% if forloop.first %}{{ block.settings.card_text_color | default: "#171717" | color_modify: "alpha", 0.75 }}{% else %}rgba(23, 23, 23, 0.75){% endif %};'
              >
                {{ block.settings.description }}
              </p>
            {% endif %}
          </div>
        </a>
      {% endif %}
    {% endfor %}
  </div>
</section>

{% stylesheet %}
  .banner-card {
    background-color: white;
  }

  .banner-card.active {
    background-color: var(--hover-bg-color) !important;
  }

  .banner-card.active .banner-card-title {
    color: var(--hover-text-color) !important;
  }

  .banner-card.active .banner-card-desc {
    color: var(--hover-text-color-75) !important;
  }

  .banner-card.active .banner-card-arrow path {
    stroke: var(--hover-text-color) !important;
  }

  .banner-card:hover {
    background-color: var(--hover-bg-color) !important;
  }

  .banner-card:hover .banner-card-title {
    color: var(--hover-text-color) !important;
  }

  .banner-card:hover .banner-card-desc {
    color: var(--hover-text-color-75) !important;
  }

  .banner-card:hover .banner-card-arrow path {
    stroke: var(--hover-text-color) !important;
  }

  /* When any card is hovered, make the first card inactive */
  #banner-cards-container:hover .banner-card.active:not(:hover) {
    background-color: white !important;
  }

  #banner-cards-container:hover
    .banner-card.active:not(:hover)
    .banner-card-title {
    color: #171717 !important;
  }

  #banner-cards-container:hover
    .banner-card.active:not(:hover)
    .banner-card-desc {
    color: rgba(23, 23, 23, 0.75) !important;
  }

  #banner-cards-container:hover
    .banner-card.active:not(:hover)
    .banner-card-arrow
    path {
    stroke: #171717 !important;
  }
{% endstylesheet %}

<script>
  document.addEventListener('DOMContentLoaded', function () {
    const cards = document.querySelectorAll('.banner-card');

    cards.forEach((card) => {
      const hoverBg = card.getAttribute('data-hover-bg');
      const hoverText = card.getAttribute('data-hover-text');

      if (hoverBg && hoverText) {
        card.style.setProperty('--hover-bg-color', hoverBg);
        card.style.setProperty('--hover-text-color', hoverText);

        // Create 75% opacity version of text color for description
        const rgb = hoverText.match(/\w\w/g);
        if (rgb) {
          const r = parseInt(rgb[0], 16);
          const g = parseInt(rgb[1], 16);
          const b = parseInt(rgb[2], 16);
          card.style.setProperty(
            '--hover-text-color-75',
            `rgba(${r}, ${g}, ${b}, 0.75)`,
          );
        }
      }
    });
  });
</script>

{% schema %}
{
  "name": "Banner med länkar",
  "tag": "section",
  "class": "section-banner-med-lankar",
  "settings": [
    {
      "type": "color",
      "id": "background_color",
      "label": "Bakgrundsfärg",
      "default": "#171717"
    },
    {
      "type": "image_picker",
      "id": "background_image",
      "label": "Bakgrundsbild"
    },
    {
      "type": "color",
      "id": "overlay_color",
      "label": "Overlay färg",
      "info": "Färg för overlay över bakgrundsbilden",
      "default": "#000000"
    },
    {
      "type": "range",
      "id": "overlay_opacity",
      "label": "Overlay opacitet",
      "info": "Transparens för overlay (0 = genomskinlig, 100 = helt ogenomskinlig)",
      "min": 0,
      "max": 100,
      "step": 5,
      "unit": "%",
      "default": 0
    },
    {
      "type": "text",
      "id": "header_button_text",
      "label": "Övre knapp text"
    },
    {
      "type": "url",
      "id": "header_button_url",
      "label": "Övre knapp länk"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Rubrik",
      "default": "Rubrik"
    },
    {
      "type": "textarea",
      "id": "description",
      "label": "Beskrivning",
      "default": "Beskrivning"
    },
    {
      "type": "text",
      "id": "primary_button_text",
      "label": "Primär knapp text"
    },
    {
      "type": "url",
      "id": "primary_button_url",
      "label": "Primär knapp länk"
    },
    {
      "type": "text",
      "id": "secondary_button_text",
      "label": "Sekundär knapp text"
    },
    {
      "type": "url",
      "id": "secondary_button_url",
      "label": "Sekundär knapp länk"
    }
  ],
  "blocks": [
    {
      "type": "card",
      "name": "Kort",
      "settings": [
        {
          "type": "text",
          "id": "heading",
          "label": "Rubrik",
          "default": "Kort rubrik"
        },
        {
          "type": "textarea",
          "id": "description",
          "label": "Beskrivning",
          "default": "Kort beskrivning"
        },
        {
          "type": "url",
          "id": "link",
          "label": "Länk"
        },
        {
          "type": "color",
          "id": "card_bg_color",
          "label": "Kortets bakgrundsfärg",
          "default": "#F3F1E8"
        },
        {
          "type": "color",
          "id": "card_text_color",
          "label": "Kortets textfärg",
          "default": "#171717"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Banner med länkar",
      "blocks": [
        {
          "type": "card"
        },
        {
          "type": "card"
        },
        {
          "type": "card"
        }
      ]
    }
  ]
}
{% endschema %}
